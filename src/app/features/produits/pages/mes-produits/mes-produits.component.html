<div class="mes-produits">
  <div class="page-header">
    <h1>Mes Produits</h1>
    <p>Gérez vos produits soumis et approuvés</p>
  </div>

  <!-- Filter tabs -->
  <div *ngIf="!isLoading && produits.length > 0" class="filter-tabs">
    <button
      type="button"
      class="filter-tab"
      [class.active]="filtreActif === 'tous'"
      (click)="changerFiltre('tous')">
      Tous ({{ getNombreProduitsParStatut('tous') }})
    </button>
    <button
      type="button"
      class="filter-tab"
      [class.active]="filtreActif === 'pending'"
      (click)="changerFiltre('pending')">
      En Attente ({{ getNombreProduitsParStatut('pending') }})
    </button>
    <button
      type="button"
      class="filter-tab"
      [class.active]="filtreActif === 'approved'"
      (click)="changerFiltre('approved')">
      Approuvés ({{ getNombreProduitsParStatut('approved') }})
    </button>
    <button
      type="button"
      class="filter-tab"
      [class.active]="filtreActif === 'rejected'"
      (click)="changerFiltre('rejected')">
      Rejetés ({{ getNombreProduitsParStatut('rejected') }})
    </button>
  </div>

  <!-- Loading state -->
  <div *ngIf="isLoading" class="loading">
    <p>Chargement de vos produits...</p>
  </div>

  <!-- Empty state -->
  <div *ngIf="!isLoading && produits.length === 0" class="empty-state">
    <div class="empty-content">
      <h2>Aucun produit trouvé</h2>
      <p>Vous n'avez pas encore ajouté de produits.</p>
      <button type="button" class="btn btn-primary" (click)="navigateToAddProduct()">
        Ajouter mon premier produit
      </button>
    </div>
  </div>

  <!-- Filtered empty state -->
  <div *ngIf="!isLoading && produits.length > 0 && produitsFiltres.length === 0" class="empty-state">
    <div class="empty-content">
      <h2>Aucun produit trouvé pour ce filtre.</h2>
      <p *ngIf="filtreActif === 'pending'">Vous n'avez pas de produits en attente d'approbation.</p>
      <p *ngIf="filtreActif === 'approved'">Vous n'avez pas de produits approuvés.</p>
      <p *ngIf="filtreActif === 'rejected'">Vous n'avez pas de produits rejetés.</p>
      <button type="button" class="btn btn-secondary" (click)="changerFiltre('tous')">
        Voir tous les produits
      </button>
    </div>
  </div>

  <!-- Products grid -->
  <div *ngIf="!isLoading && produits.length > 0 && produitsFiltres.length > 0" class="products-grid">
    <div class="product-card" *ngFor="let produit of produitsFiltres">
      <div class="product-image">
        <img [src]="getMainImage(produit.images || [produit.images[0]])" [alt]="produit.name" class="product-image-preview">
        <div class="image-overlay">
          <button
            type="button"
            class="btn-view-real"
            (click)="openRealPhotoModal(produit)"
            title="Voir la photo en taille réelle">
            Voir en grand
          </button>
        </div>
      </div>

      <div class="product-info">
        <h3 class="product-name">{{ produit.name }}</h3>
        <p class="product-category">{{ produit.category }}</p>
        <p class="product-description">{{ produit.description }}</p>

        <div class="product-details">
          <div class="detail-item">
            <span class="label">Prix:</span>
            <span class="value">{{ formatPrice(produit.price) }}</span>
          </div>
          <div class="detail-item">
            <span class="label">Stock:</span>
            <span class="value">{{ produit.stock }}</span>
          </div>
          <div class="detail-item">
            <span class="label">Date:</span>
            <span class="value">{{ produit.createdAt ? formatDate(produit.createdAt) : 'N/A' }}</span>
          </div>
        </div>

        <div class="product-status">
          <span class="badge" [ngClass]="getBadgeClass(produit.status)">
            <i class="fas" [ngClass]="{
              'fa-clock': produit.status === 'pending',
              'fa-check': produit.status === 'approved'
            }"></i>
            {{ getBadgeText(produit.status) }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Real photo modal -->
  <div *ngIf="showRealPhotoModal" class="modal-overlay" (click)="closeRealPhotoModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>{{ selectedProductForModal?.name }}</h2>
        <button type="button" class="btn-close" (click)="closeRealPhotoModal()">
          ×
        </button>
      </div>

      <div class="modal-body">
        <img
          *ngIf="selectedProductForModal"
          [src]="getMainImage(selectedProductForModal.images || [selectedProductForModal.images[0]])"
          [alt]="selectedProductForModal.name"
          class="real-photo">
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closeRealPhotoModal()">
          Fermer
        </button>
      </div>
    </div>
  </div>
</div>